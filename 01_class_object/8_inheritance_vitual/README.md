[MindMap](./inheritance_vitual.png)
[demo](./demo.cpp)


# C++ 进阶笔记：继承、多态与接口 (Inheritance & Polymorphism)

> **核心思想**：面向对象编程 (OOP) 的三大支柱中，**多态 (Polymorphism)** 是最灵活、最强大的特性。它允许我们使用“通用的接口”来操作“不同的具体对象”。

## 1. 继承 (Inheritance)
**定义**：允许一个类（派生类/子类）获取另一个类（基类/父类）的属性和方法。

* **核心价值**：
    * **代码复用 (Code Reuse)**：避免重复编写相同的逻辑。
    * **层次结构 (Hierarchy)**：建立清晰的“Is-A”（是一个）关系（例如：`Cat` is an `Animal`）。
    * **扩展性**：在不修改原有代码的基础上增加新功能。
* **语法**：
    ```cpp
    class Derived : public Base { ... };
    ```

## 2. 虚函数与多态 (Virtual Functions & Polymorphism)
这是 C++ 实现“动态行为”的关键。

### 2.1 什么是多态？
多态是指：**同一个函数调用，根据对象实际类型的不同，执行不同的逻辑**。
* **静态绑定 (Static Binding)**：编译时确定调用哪个函数（默认行为，效率高）。
* **动态绑定 (Dynamic Binding)**：运行时确定调用哪个函数（需使用 `virtual`）。

### 2.2 虚函数 (Virtual Functions)
在基类中用 `virtual` 关键字修饰的函数。
* **作用**：告诉编译器，“不要在编译时把这个函数调用写死，等到运行时看具体是谁在调用”。
* **override 关键字 (C++11)**：在子类重写函数时显式加上 `override`，让编译器帮你检查拼写错误或签名不匹配问题（**强烈推荐**）。

### 2.3 底层机制：虚函数表 (V-Table) [拓展知识]
为什么虚函数能实现多态？
* **V-Table**：编译器为每个包含虚函数的**类**生成一张表，里面存着该类所有虚函数的地址。
* **vptr**：每个**对象**内部隐藏着一个指针（vptr），指向所属类的 V-Table。
* **性能开销**：
    1.  **空间**：每个对象多一个指针大小的内存。
    2.  **时间**：调用函数时需要查表（指针间接跳转），比普通函数稍慢。

---

## 3. 抽象类与接口 (Abstract Classes & Interfaces)
当基类无法给出具体的实现时（例如“形状”的面积，“动物”的叫声），就需要用到纯虚函数。

### 3.1 纯虚函数 (Pure Virtual Functions)
* **语法**：`virtual void func() = 0;`
* **含义**：基类没有实现，**强制**要求子类必须实现。

### 3.2 抽象类 (Abstract Class)
* 只要类中包含**至少一个**纯虚函数，该类就是抽象类。
* **限制**：**不能实例化**（即不能 `new Animal()`，只能 `new Cat()`）。

### 3.3 接口 (Interface)
C++ 中没有 `interface` 关键字，但通常将**“只包含纯虚函数且无成员变量”**的抽象类称为接口。它代表一种“能力”或“协议”。

---

## 4. [重要拓展] 虚析构函数 (Virtual Destructor)
**面试必问/新手必坑点**：
如果你的类主要是作为**基类**使用（尤其是包含虚函数时），**必须**将析构函数声明为 `virtual`。

* **原因**：当你用 `Base*` 指针指向 `Derived` 对象并执行 `delete` 时，如果析构函数不是虚函数，**只会调用 Base 的析构函数**，而不会调用 Derived 的析构函数。
* **后果**：子类中申请的内存无法释放，导致**内存泄漏**。

```cpp
virtual ~Base() {} // 基类务必加上 virtual